<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mes.bf.rsc.mapper.RscReturnMapper">

	<select id="returnList" resultType="com.mes.bf.rsc.vo.RscReturnVO">
		SELECT RTN.RSC_RETURN_CODE, 
		       RTN.RSC_RETURN_DATE, 
		       RTN.RSC_CD_CODE, 
               RTN.RSC_RETURN_VOL, 
               RTN.RSC_RETURN_PRC, 
               RTN.RSC_RETURN_RESN, 
               RTN.RSC_RETURN_REMK,
               
		       RSCCODE.RSC_CD_NAME, 
		       RSCCODE.RSC_CD_UNIT,
		       
               EMP.EMP_NAME,

               VEND.VEND_CD_NM
               
		 FROM  BF_RSC_RETURN RTN 
		 LEFT  JOIN BF_CMN_RSC_CODE RSCCODE
		   ON  RTN.RSC_CD_CODE = RSCCODE.RSC_CD_CODE
		 LEFT  JOIN BF_CMN_EMP EMP
		   ON  RTN.EMP_ID = EMP.EMP_ID
		 LEFT  JOIN BF_CMN_VENDOR_CODE VEND
		   ON  RTN.VEND_CD_CODE = VEND.VEND_CD_CODE
		 <where>
		 	<if test="rscReturnCode != null and rscReturnCode != ''">
		 		RTN.RSC_RETURN_CODE = '%'||#{rscReturnCode}||'%'
		 	</if>
		 	<if test="vendor != null and vendor != ''">
		 		RTN.VEND_CD_CODE = #{vendor}
		 	</if>
		 	<if test="rscReturnSDate != null and rscReturnSDate != ''">
		 		<![CDATA[RTN.RSC_RETURN_DATE >= #{rscReturnSDate} 
		 			 AND RTN.RSC_RETURN_DATE <= #{rscReturnEDate}]]>
		 	</if>
		 </where>
		ORDER  BY 1 DESC
	</select>
	
	
	<insert id="returnInsert" parameterType="com.mes.bf.rsc.vo.RscReturnVO">
		INSERT INTO BF_RSC_RETURN
		
		VALUES (
				'RSC_RTN' || LPAD(BF_RSC_RETURN_SEQ.nextval,3,0),
				#{rscCdCode},
				#{rscLotNo},
				#{rscReturnDate},
				#{rscReturnVol},
				'처리고민',
				#{rscReturnPrc},
				#{rscReturnRemk},
				#{empId},
				#{vendCdCode}
				)
	</insert>
	
	<update id="returnUpdate" parameterType="com.mes.bf.rsc.vo.RscReturnVO">
		UPDATE BF_RSC_RETURN
		<set>
			RSC_RETURN_DATE = #{rscReturnDate}
			,VEND_CD_CODE = #{vendCdCode}
			,RSC_CD_CODE = #{rscCdCode}
			,RSC_LOT_NO = #{rscLotNo}
			,RSC_RETURN_VOL = #{rscReturnVol}
			,RSC_RETURN_PRC = #{rscReturnPrc}
			,EMP_ID = #{empId}
			,RSC_RETURN_REMK = #{rscReturnRemk}
		</set>
		WHERE RSC_RETURN_CODE = #{rscReturnCode}
	</update>
	
</mapper>